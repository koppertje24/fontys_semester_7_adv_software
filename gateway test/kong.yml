_format_version: "3.0"

# Define backend services
services:
  # HTTPBin - for testing HTTP methods, headers, etc.
  - name: httpbin-service
    url: http://httpbin:80
    routes:
      - name: httpbin-route
        paths:
          - /httpbin
        strip_path: true
    plugins:
      - name: rate-limiting
        config:
          minute: 10
          hour: 100
      - name: cors
        config:
          origins:
            - "*"
          methods:
            - GET
            - POST
          headers:
            - Accept
            - Authorization
          
  # JSONPlaceholder - fake REST API
  - name: json-api-service
    url: http://jsonplaceholder:80
    routes:
      - name: json-api-route
        paths:
          - /api
        strip_path: true
    plugins:
      - name: rate-limiting
        config:
          minute: 20
      - name: key-auth
        config:
          key_names:
            - apikey

# Define API consumers
consumers:
  - username: demo-user
    keyauth_credentials:
      - key: demo-api-key-123
      
  - username: test-user
    keyauth_credentials:
      - key: test-key-456